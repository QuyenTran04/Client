.ai-fab{
  position: fixed; right: 20px; bottom: 20px;
  width: 56px; height: 56px; border-radius: 50%;
  border: none; cursor: pointer; box-shadow: 0 8px 24px rgba(0,0,0,.15);
  background: #111827; color: #fff; font-size: 20px;
}

.ai-chat{
  position: fixed; right: 20px; bottom: 90px; width: 360px; max-height: 70vh;
  background: #fff; border-radius: 16px; box-shadow: 0 12px 36px rgba(0,0,0,.18);
  display: none; flex-direction: column; overflow: hidden;
}
.ai-chat.open{ display: flex; }

.ai-chat__header{
  display: flex; align-items: center; gap: 8px;
  padding: 12px 14px; background: #111827; color: #fff;
}
.ai-chat__title{ font-weight: 700; flex: 1; }
.ai-chat__meta{ opacity: .8; font-size: 12px; }
.ai-chat__close{
  border: none; background: transparent; color: #fff; font-size: 20px; cursor: pointer;
}

.ai-chat__body{
  padding: 12px; overflow: auto; flex: 1; background: #f9fafb;
}
.ai-chat__hint{
  margin: 12px auto; color:#6b7280; text-align:center; font-size:14px;
  background: #fff; padding:10px 12px; border-radius:10px; width: 85%;
}

.ai-msg{ display:flex; margin: 8px 0; }
.ai-msg--user{ justify-content:flex-end; }
.ai-msg__bubble{
  max-width: 80%; padding: 10px 12px; border-radius: 14px; line-height: 1.45; white-space: pre-wrap;
  background: #fff; border: 1px solid #e5e7eb;
}
.ai-msg--user .ai-msg__bubble{ background: #111827; color:#fff; border-color: transparent; }
.ai-msg--bot .ai-msg__bubble{ background: #fff; }
.ai-msg--error .ai-msg__bubble{ background:#fee2e2; border-color:#fecaca; color:#991b1b; }
.ai-msg__time{ align-self:flex-end; font-size: 11px; color: #9ca3af; margin: 0 8px; }

.ai-chat__composer{
  border-top: 1px solid #e5e7eb; padding: 8px; display:flex; gap:8px; background:#fff;
}
.ai-chat__composer textarea{
  flex:1; resize:none; border:1px solid #e5e7eb; border-radius: 10px; padding: 10px 12px; font: inherit; outline: none;
}
.ai-send{
  min-width: 72px; border:none; background:#111827; color:#fff; border-radius: 10px; cursor:pointer; padding: 0 14px;
}
.ai-send:disabled{ opacity:.6; cursor:not-allowed; }

.typing { display:inline-flex; gap:4px; }
.typing i{ width:6px; height:6px; border-radius:50%; background:#9ca3af; display:block; animation: t 1s infinite ease-in-out; }
.typing i:nth-child(2){ animation-delay: .15s; }
.typing i:nth-child(3){ animation-delay: .3s; }
@keyframes t { 0%,80%,100%{ transform: translateY(0) } 40%{ transform: translateY(-4px) } }
.ai-drawer{
  position: fixed; top: 0; right: 0;
  width: 380px; max-width: 92vw; height: 100vh;
  background: #fff; box-shadow: -12px 0 36px rgba(0,0,0,.18);
  display: flex; flex-direction: column; overflow: hidden;
  transform: translateX(100%); transition: transform .28s ease;
  z-index: 60;
}
.ai-drawer.open{ transform: translateX(0); }

.ai-drawer .ai-chat__header{ background:#111827; color:#fff; }
.ai-drawer .ai-chat__body{ flex: 1; overflow: auto; background:#f9fafb; }
.ai-drawer .ai-chat__composer{ border-top:1px solid #e5e7eb; background:#fff; }

/* Nút mở ngăn kéo (dọc viền phải) */
.ai-drawer__handle{
  position: fixed; top: 40%; right: 0;
  transform: translateY(-50%);
  writing-mode: vertical-rl;
  padding: 10px 8px; border-radius: 10px 0 0 10px;
  border: none; cursor: pointer; z-index: 55;
  background:#111827; color:#fff; letter-spacing: 2px; font-weight: 700;
  box-shadow: 0 8px 24px rgba(0,0,0,.15);
}
.ai-drawer__handle.hide{ display: none; }

/* Popup floating cũ (vẫn dùng ngoài Course) */
.ai-fab{ position: fixed; right: 20px; bottom: 20px; width:56px; height:56px; border-radius:50%; border:none; cursor:pointer; box-shadow:0 8px 24px rgba(0,0,0,.15); background:#111827; color:#fff; font-size:20px; z-index:50; }
.ai-chat{ position: fixed; right: 20px; bottom: 90px; width: 360px; max-height: 70vh; background:#fff; border-radius:16px; box-shadow:0 12px 36px rgba(0,0,0,.18); display:none; flex-direction:column; overflow:hidden; z-index:50; }
.ai-chat.open{ display:flex; }

/* Giữ các style bong bóng, composer, typing… y như bạn đã có */
.ai-chat__header{ display:flex; align-items:center; gap:8px; padding:12px 14px; background:#111827; color:#fff; }
.ai-chat__title{ font-weight:700; flex:1; }
.ai-chat__meta{ opacity:.8; font-size:12px; }
.ai-chat__close{ border:none; background:transparent; color:#fff; font-size:20px; cursor:pointer; }

.ai-chat__body{ padding:12px; overflow:auto; flex:1; background:#f9fafb; }
.ai-chat__hint{ margin:12px auto; color:#6b7280; text-align:center; font-size:14px; background:#fff; padding:10px 12px; border-radius:10px; width:85%; }

.ai-msg{ display:flex; margin:8px 0; }
.ai-msg--user{ justify-content:flex-end; }
.ai-msg__bubble{ max-width:80%; padding:10px 12px; border-radius:14px; line-height:1.45; white-space:pre-wrap; background:#fff; border:1px solid #e5e7eb; }
.ai-msg--user .ai-msg__bubble{ background:#111827; color:#fff; border-color:transparent; }
.ai-msg--bot .ai-msg__bubble{ background:#fff; }
.ai-msg--error .ai-msg__bubble{ background:#fee2e2; border-color:#fecaca; color:#991b1b; }
.ai-msg__time{ align-self:flex-end; font-size:11px; color:#9ca3af; margin:0 8px; }

.ai-chat__composer{ border-top:1px solid #e5e7eb; padding:8px; display:flex; gap:8px; background:#fff; }
.ai-chat__composer textarea{ flex:1; resize:none; border:1px solid #e5e7eb; border-radius:10px; padding:10px 12px; font:inherit; outline:none; }
.ai-send{ min-width:72px; border:none; background:#111827; color:#fff; border-radius:10px; cursor:pointer; padding:0 14px; }
.ai-send:disabled{ opacity:.6; cursor:not-allowed; }

.typing{ display:inline-flex; gap:4px; }
.typing i{ width:6px; height:6px; border-radius:50%; background:#9ca3af; display:block; animation:t 1s infinite ease-in-out; }
.typing i:nth-child(2){ animation-delay:.15s; }
.typing i:nth-child(3){ animation-delay:.3s; }
@keyframes t{ 0%,80%,100%{ transform:translateY(0) } 40%{ transform:translateY(-4px) } }

/* Mobile tối ưu (drawer full width) */
@media (max-width: 640px){
  .ai-drawer{ width: 100vw; max-width: 100vw; }
}